<!DOCTYPE html>
<html lang="eS">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Listado de tareas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../static/estilos_task.css">
</head>

<body>

    <nav class="navbar navbar-expand-lg bg-light">
        <div class="container-fluid">
            <a class="navbar-brand fw-bolder" href="#"> </a>
            <span>Bienvenido/a {{session['name']}}<a href="/" class="mx-3">Salir</a></span>
        </div>
    </nav>

    <div class="container2">
        <div class="row">
            <div class="col-12 text-center">
                <h1 class="mt-4 titulo2">Webdesign inspiration</h1>
                <h3 class="titulo3">Ahorra tiempo sin esfuerzo y mantente inspirado: Agiliza tu flujo de trabajo con
                    Bookmarkify. encuentra toda tu inspiración de diseño en un solo lugar.
                </h3>
                <button type="button" class="btn_agregar btn btn-primary my-2" data-bs-toggle="modal"
                    data-bs-target="#taskModal" data-taskid="0">Agregar una pagina <i class="fas fa-plus"></i></button>

                <table class="table table-bordered table-hover tablita">
                    <thead>
                        <tr>
                            <!-- <th scope="col">#</th> -->
                            <th scope="col">Nombre</th>
                            <th scope="col">Enlace</th>
                            <th scope="col">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for task in tasks %}
                        <tr>
                            <!-- <th scope="row">{{ task[0] }}</th> id -->
                            <td class="">
                                <div class="flex__descripcion1">
                                    <p class="task1">{{ task[1] }}</p>
                                </div>
                            </td> <!--nombre -->

                            <td>
                                <div class="flex__descripcion">
                                    <a class="texto__enlace" href="{{ task[2] }}">{{ task[2] }}</a>
                                    <img class="imagen" src="../static/imagenes/img1.png" alt="" </td> <!--desc-->
                                </div>
                            <td>
                                <div class="flex__btns">
                                    <button type="button" class="btn__editar btn btn-primary btn-sm"
                                        data-bs-toggle="modal" data-bs-target="#taskModal" data-bs-id="{{task[0]}}"
                                        data-bs-nombre="{{task[1]}}" data-bs-descripcion="{{task[2]}}">Editar <i
                                            class="fas fa-edit"></i>
                                    </button>

                                    <form action="/delete_task" method="post" id="deleteTaskForm">
                                        <input type="hidden" name="task_id" id="deleteTaskId" value="{{task[0]}}">
                                        <button type="submit" id="delete__btn" class="btn btn-danger">Eliminar<i
                                                class="fas fa-trash-alt"></i>
                                        </button>
                                    </form>
                                </div>

                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Modal para crear/editar tarea -->
    <div class="modal fade" id="taskModal" tabindex="-1" role="dialog" aria-labelledby="taskModalLabel"
        aria-hidden="true">

        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="taskModalLabel">Agregar Pagina</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                    </button>
                </div>

                <div class="modal-body">

                    <form id="taskForm" method="POST" action="{{ url_for('add_task') }}">
                        <input type="hidden" id="taskId" name="taskId">
                        <div class="form-group">
                            <label for="nombre">Nombre:</label>
                            <input type="text" class="form-control" id="nombre" name="nombre" required>
                        </div>
                        <div class="form-group">
                            <label for="descripcion">Enlace:</label>
                            <input type="text" class="form-control" id="descripcion" name="descripcion" required>
                        </div>
                        <div class="form-group text-center mt-2">
                            <button type="submit" class="btn btn-primary">Guardar</button>
                        </div>
                    </form>

                </div>
            </div>
        </div>
    </div>
</body>



<script>

    const nombreModal = document.getElementById('taskModal')
    if (nombreModal) {
        nombreModal.addEventListener('show.bs.modal', event => {
            // Button that triggered the modal
            const button = event.relatedTarget
            // Extract info from data-bs-* attributes
            const id = button.getAttribute('data-bs-id')
            const name = button.getAttribute('data-bs-nombre')
            const desc = button.getAttribute('data-bs-descripcion')
            // If necessary, you could initiate an Ajax request here
            // and then do the updating in a callback.

            // Update the modal's content.
            const modalNombre = nombreModal.querySelector('#nombre')
            const modalDesc = nombreModal.querySelector('#descripcion')
            //  const modalBodyInput = exampleModal.querySelector('.modal-body input')

            //modal.textContent = `New message to ${recipient}`
            modalNombre.value = name
            modalDesc.value = desc
            if (id) {
                nombreModal.querySelector('.modal-title').textContent = 'Editar tarea';
                nombreModal.querySelector('#taskForm').setAttribute('action', '{{ url_for("edit_task", id=0) }}'.replace('0', id));
            } else {
                nombreModal.querySelector('.modal-title').textContent = 'Agregar tarea';
            }
        })
    }

    document.getElementById("delete__btn").addEventListener("click", function () {
            if (confirm("¿Estás seguro de que deseas Eliminar?")) {
                // Si el usuario confirma, realizar alguna acción, por ejemplo, redireccionar a otra página
                window.location.href = "";
            } else {
                // Si el usuario cancela, no hacer nada
            }
        });
    


</script>

</html>